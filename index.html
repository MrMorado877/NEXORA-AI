<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="google-site-verification" content="qLKwdVfAn0qgmnyOxefdD3EfWTbYMth60QPmLUJcww4" />                                                                                            
<title>What are you going to make today?</title>
<style>
/* Basic matte black theme */
body {
  margin:0;
  font-family:Arial,sans-serif;
  background:#121212;
  color:white;
  overflow-x:hidden;
}

/* Header */
header{
  background:#1c1c1c;
  padding:15px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
  letter-spacing:0.5px;
  position:relative;
}

/* Hamburger for sidebar */
#hamburger{
  position:absolute;
  left:15px;
  top:15px;
  font-size:28px;
  cursor:pointer;
}

/* Sidebar for chat history */
#sidebar{
  height:100%;
  width:0;
  position:fixed;
  top:0;
  left:0;
  background:#1b1b1b;
  overflow-x:hidden;
  transition:0.3s;
  padding-top:60px;
  box-shadow:2px 0 10px #000;
}
#sidebar h2{
  color:#0ff;
  text-align:center;
  margin-bottom:20px;
}
#sidebar ul{
  list-style:none;
  padding:0 15px;
  max-height:80%;
  overflow-y:auto;
}
#sidebar li{
  margin-bottom:10px;
  padding:8px;
  background:#222;
  border-radius:6px;
  cursor:pointer;
}
#sidebar li:hover{
  background:#333;
}

/* Chat box */
#chatBox{
  height:calc(100vh - 80px);
  overflow-y:auto;
  padding:15px;
  margin-left:0;
  transition:margin-left 0.3s;
}
.message{
  padding:10px 14px;
  margin:10px 0;
  max-width:75%;
  border-radius:12px;
  white-space:pre-wrap;
  word-wrap:break-word;
  opacity:0;
  animation:fadeIn 0.3s forwards;
}
.user{background:#222;margin-left:auto;}
.ai{background:#333;margin-right:auto;}

/* Fade in animation */
@keyframes fadeIn {
  to {opacity:1;}
}

/* Code blocks */
.codeBlock{
  background:#0f0f0f;
  color:#0f0;
  padding:10px;
  border-radius:8px;
  font-family:monospace;
  position:relative;
  margin-top:8px;
}
.codeButtons{
  position:absolute;
  top:5px;
  right:5px;
}
.codeButtons button{
  margin-left:5px;
  padding:3px 6px;
  font-size:12px;
  border:none;
  border-radius:4px;
  cursor:pointer;
  background:#0ff;
  color:#000;
}

/* Bottom input */
.bottom{
  display:flex;
  padding:10px;
  background:#1b1b1b;
  position:fixed;
  bottom:0;
  width:100%;
  box-shadow:0 -2px 10px #000;
}
#userInput{
  flex:1;
  padding:15px;
  border-radius:25px;
  border:none;
  background:#222;
  color:white;
}
#sendBtn{
  width:50px;
  height:50px;
  margin-left:10px;
  border-radius:50%;
  border:none;
  background:cyan;
  font-size:22px;
  cursor:pointer;
}

/* Voice button */
#assistantBtn{
  position:fixed;
  bottom:80px;
  right:20px;
  width:60px;
  height:60px;
  border-radius:50%;
  background:cyan;
  color:black;
  font-size:28px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 15px cyan;
}
@keyframes glow{
  0%{box-shadow:0 0 5px #0ff;}
  50%{box-shadow:0 0 25px #0ff;}
  100%{box-shadow:0 0 5px #0ff;}
}
#assistantBtn:hover{
  animation:glow 1.5s infinite;
}

/* Loading animation */
.loader{
  border:4px solid #222;
  border-top:4px solid cyan;
  border-radius:50%;
  width:20px;
  height:20px;
  animation:spin 1s linear infinite;
  display:inline-block;
  margin-left:10px;
}
@keyframes spin{
  0%{transform:rotate(0deg);}
  100%{transform:rotate(360deg);}
}

/* Feature buttons above input */
#featureButtons{
  display:flex;
  gap:10px;
  justify-content:center;
  padding:10px;
}
.featureBtn{
  padding:5px 12px;
  background:#222;
  border:none;
  border-radius:6px;
  cursor:pointer;
  color:white;
}
.featureBtn:hover{background:#333;}
</style>
</head>
<body>

<header>
  <span id="hamburger">&#9776;</span>
  âœ¨ What are you going to make today?
</header>

<div id="sidebar">
  <h2>Chat History</h2>
  <ul id="historyList"></ul>
</div>

<div id="featureButtons">
  <button class="featureBtn" onclick="clearChat()">Clear Chat</button>
  <button class="featureBtn" onclick="downloadChat()">Download Chat</button>
</div>

<div id="chatBox"></div>

<div class="bottom">
  <input id="userInput" placeholder="Message AI...">
  <button id="sendBtn">â¬†</button>
</div>

<div id="assistantBtn" title="Voice Input">ðŸŽ¤</div>

<script>
const BACKEND = "https://mr-ai.onrender.com"; // Your live Render backend
// Replace with your API endpoint
let chatHistory = JSON.parse(localStorage.getItem("chatHistory") || "[]");

// Sidebar toggle
document.getElementById("hamburger").onclick = () => {
  const sidebar = document.getElementById("sidebar");
  const chatBox = document.getElementById("chatBox");
  if(sidebar.style.width === "250px"){
    sidebar.style.width = "0";
    chatBox.style.marginLeft = "0";
  } else {
    sidebar.style.width = "250px";
    chatBox.style.marginLeft = "250px";
  }
};

// Load chat history
chatHistory.forEach(item => addMessage(item.text, item.type, false));

// Add message to chat
function addMessage(text,type,save=true){
  const box=document.getElementById("chatBox");
  const div=document.createElement("div");
  div.className=`message ${type}`;

  if(text.includes("```")){
    const codeContent = text.replace(/```/g,"");
    const codeDiv = document.createElement("div");
    codeDiv.className="codeBlock";
    codeDiv.innerText = codeContent;

    const btnDiv = document.createElement("div");
    btnDiv.className="codeButtons";
    const copyBtn = document.createElement("button");
    copyBtn.innerText="Copy";
    copyBtn.onclick=()=>{navigator.clipboard.writeText(codeContent);}
    const editBtn = document.createElement("button");
    editBtn.innerText="Edit";
    editBtn.onclick=()=>{document.getElementById("userInput").value = codeContent; document.getElementById("userInput").focus();}
    btnDiv.appendChild(copyBtn);
    btnDiv.appendChild(editBtn);
    codeDiv.appendChild(btnDiv);
    div.appendChild(codeDiv);
  } else {
    div.innerText=text;
  }

  box.appendChild(div);
  box.scrollTop=box.scrollHeight;

  if(save){
    chatHistory.push({type,text});
    localStorage.setItem("chatHistory", JSON.stringify(chatHistory));
  }

  // Update sidebar history
  const historyList=document.getElementById("historyList");
  const li=document.createElement("li");
  li.innerText=(type==="user"?"You: ":"AI: ") + text.replace(/```/g,"");
  li.onclick=()=>{document.getElementById("userInput").value=text.replace(/```/g,""); sendChat();}
  historyList.appendChild(li);
}

// Send chat
async function sendChat(){
  const input=document.getElementById("userInput");
  const msg=input.value.trim();
  if(!msg) return;

  addMessage(msg,"user");
  input.value="";

  const loader = document.createElement("span");
  loader.className="loader";
  const lastDiv = document.createElement("div");
  lastDiv.className="message ai";
  lastDiv.appendChild(loader);
  document.getElementById("chatBox").appendChild(lastDiv);
  document.getElementById("chatBox").scrollTop=document.getElementById("chatBox").scrollHeight;

  try{
    const res = await fetch(BACKEND+"/api/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:msg})
    });
    const data = await res.json();
    lastDiv.remove();
    const reply = data.reply || "Sorry, no response!";
    addMessage(reply,"ai");
    speak(reply);
  }catch(e){
    lastDiv.remove();
    console.error(e);
    addMessage("Error: Could not reach AI","ai");
  }
}

// Clear chat
function clearChat(){
  chatHistory = [];
  localStorage.removeItem("chatHistory");
  document.getElementById("chatBox").innerHTML="";
  document.getElementById("historyList").innerHTML="";
}

// Download chat
function downloadChat(){
  const blob = new Blob([JSON.stringify(chatHistory,null,2)],{type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "chat_history.json";
  a.click();
}

// Voice input
document.getElementById("assistantBtn").onclick=()=> {
  const recognition=new (window.SpeechRecognition||window.webkitSpeechRecognition)();
  recognition.lang="en-US";
  recognition.start();
  recognition.onresult=e=>{
    const msg=e.results[0][0].transcript;
    document.getElementById("userInput").value=msg;
    sendChat();
  };
};

// Voice output
function speak(text){
  const utter=new SpeechSynthesisUtterance(text);
  utter.lang="en-US";
  speechSynthesis.speak(utter);
}

// Send button & Enter key
document.getElementById("sendBtn").onclick=sendChat;
document.getElementById("userInput").addEventListener("keypress",e=>{if(e.key==="Enter") sendChat();});
</script>
</body>
</html>

