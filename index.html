<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
  <meta name="google-site-verification" content="qLKwdVfAn0qgmnyOxefdD3EfWTbYMth60QPmLUJcww4" />

<title>NEXORA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="icon" href="/NEXORA-AI/favicon.png" type="image/png">
<link rel="shortcut icon" href="/NEXORA-AI/favicon.png" type="image/png">
<link rel="apple-touch-icon" href="/NEXORA-AI/favicon.png">

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<style>
:root{
  --bg:#000;
  --glass:rgba(0,0,0,.55);
  --border:rgba(255,255,255,.15);
  --text:#fff;
}
body.light{
  --bg:#f4f4f4;
  --glass:rgba(255,255,255,.6);
  --border:rgba(0,0,0,.15);
  --text:#000;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{
  height:100vh;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}

/* Toggle Button */
.toggle-btn{
  position:fixed;top:20px;left:20px;
  width:42px;height:42px;border-radius:50%;
  border:none;cursor:pointer;
  background:rgba(255,255,255,.15);
  color:var(--text);font-size:20px;
  z-index:50;
}

/* Sidebar */
.sidebar{
  position:fixed;left:0;top:0;width:260px;height:100%;
  background:var(--glass);backdrop-filter:blur(20px);
  border-right:1px solid var(--border);
  padding:20px;transition:.3s;z-index:20;
}
.sidebar.closed{transform:translateX(-100%)}

.app-name{
  font-size:28px;font-weight:900;letter-spacing:3px;
  margin-bottom:20px;
  background:linear-gradient(90deg,#7f5cff,#00ffd5,#7f5cff);
  background-size:300% 300%;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:grad 6s infinite,glow 2s infinite;
}
@keyframes grad{
  0%{background-position:0%}
  50%{background-position:100%}
  100%{background-position:0%}
}
@keyframes glow{
  0%,100%{filter:drop-shadow(0 0 6px #7f5cff)}
  50%{filter:drop-shadow(0 0 16px #00ffd5)}
}

.new-chat{
  width:100%;padding:10px;
  border-radius:10px;
  background:transparent;
  border:1px solid var(--border);
  color:var(--text);cursor:pointer;
  margin-bottom:15px;
}

.chat-title{
  padding:8px 0;
  font-size:14px;
  border-bottom:1px solid var(--border);
  cursor:pointer;
  opacity:.8;
}
.chat-title:hover{opacity:1}

/* Main */
.main{
  margin-left:260px;height:100vh;
  display:flex;flex-direction:column;
  align-items:center;transition:.3s;
}
.main.full{margin-left:0}

#chatArea{
  width:70%;max-width:720px;
  flex:1;overflow-y:auto;padding:20px;
}

.message{
  max-width:80%;padding:12px 16px;
  margin-bottom:12px;border-radius:16px;
  background:rgba(255,255,255,.1);
}
.user{margin-left:auto;border-bottom-right-radius:4px}
.bot{margin-right:auto;border-bottom-left-radius:4px}

/* Input */
.search-wrapper{
  width:70%;max-width:720px;
  margin-bottom:20px;position:relative;
}
.search-bar{
  width:100%;padding:16px 50px;
  border-radius:30px;
  background:var(--glass);
  border:1px solid var(--border);
  color:var(--text);font-size:16px;
}
.send-btn{
  position:absolute;right:12px;bottom:10px;
  width:36px;height:36px;border-radius:50%;
  border:none;background:rgba(255,255,255,.2);
  color:var(--text);font-size:18px;
}

/* Theme Toggle */
.theme-btn{
  position:absolute;bottom:20px;left:20px;
  cursor:pointer;font-size:14px;
}
</style>
</head>

<body>

<button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>

<div class="sidebar" id="sidebar">
  <div class="app-name">NEXORA</div>
  <button class="new-chat" onclick="newChat()">ï¼‹ New Chat</button>
  <div id="chatTitles"></div>
  <div class="theme-btn" onclick="toggleTheme()">ðŸŒ™ Toggle Theme</div>
</div>

<div class="main" id="main">
  <div id="chatArea"></div>
  <div class="search-wrapper">
    <input id="input" class="search-bar" placeholder="Type messageâ€¦" />
    <button class="send-btn" onclick="sendMessage()">â†‘</button>
  </div>
</div>

<script>
const backend="https://backend-b80q.onrender.com/api/chat";
const sidebar=document.getElementById("sidebar");
const main=document.getElementById("main");
const chatArea=document.getElementById("chatArea");
const input=document.getElementById("input");

let chats=JSON.parse(localStorage.getItem("nexoraChats")||"[]");
let currentChat=null;

/* Sidebar */
function toggleSidebar(){
  sidebar.classList.toggle("closed");
  main.classList.toggle("full");
}

/* Theme */
function toggleTheme(){
  document.body.classList.toggle("light");
}

/* Chats */
function save(){localStorage.setItem("nexoraChats",JSON.stringify(chats));}

function newChat(){
  currentChat={id:Date.now(),title:"New Chat",messages:[]};
  chats.unshift(currentChat);
  save();renderTitles();loadChat(currentChat);
}

function renderTitles(){
  const box=document.getElementById("chatTitles");
  box.innerHTML="";
  chats.forEach(c=>{
    const d=document.createElement("div");
    d.className="chat-title";
    d.textContent=c.title;
    d.onclick=()=>loadChat(c);
    box.appendChild(d);
  });
}

function loadChat(chat){
  currentChat=chat;
  chatArea.innerHTML="";
  chat.messages.forEach(m=>addMessage(m.text,m.role,false));
}

/* Messages */
function addMessage(text,role,store=true){
  const d=document.createElement("div");
  d.className=`message ${role}`;
  d.innerHTML=marked.parse(text);
  chatArea.appendChild(d);
  chatArea.scrollTop=chatArea.scrollHeight;

  if(store){
    currentChat.messages.push({role,text});
    if(currentChat.messages.length===1){
      currentChat.title=text.slice(0,25);
      renderTitles();
    }
    save();
  }
  return d;
}

function typeEffect(el,text){
  el.innerHTML="";
  let i=0,words=text.split(" ");
  const t=setInterval(()=>{
    el.innerHTML+=words[i]+" ";
    chatArea.scrollTop=chatArea.scrollHeight;
    i++;if(i>=words.length)clearInterval(t);
  },40);
}

/* Send */
input.addEventListener("keydown",e=>{if(e.key==="Enter")sendMessage();});

async function sendMessage(){
  if(!currentChat)newChat();
  const msg=input.value.trim();
  if(!msg)return;
  addMessage(msg,"user");
  input.value="";

  const botDiv=document.createElement("div");
  botDiv.className="message bot";
  chatArea.appendChild(botDiv);

  try{
    const r=await fetch(backend,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:msg})
    });
    const d=await r.json();
    typeEffect(botDiv,d.reply);
    currentChat.messages.push({role:"bot",text:d.reply});
    save();
  }catch{
    botDiv.textContent="Server error";
  }
}

/* Mobile swipe */
let startX=0;
document.addEventListener("touchstart",e=>startX=e.touches[0].clientX);
document.addEventListener("touchend",e=>{
  let endX=e.changedTouches[0].clientX;
  if(endX-startX>80)sidebar.classList.remove("closed"),main.classList.remove("full");
  if(startX-endX>80)sidebar.classList.add("closed"),main.classList.add("full");
});

/* Init */
if(chats.length){loadChat(chats[0]);renderTitles();}
</script>

</body>
</html>
